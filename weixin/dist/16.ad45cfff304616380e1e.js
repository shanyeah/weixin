webpackJsonp([16],{474:function(e,t,a){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(185),o=n(l),u=a(9),d=n(u),i=a(5),s=n(i),c=a(8),f=n(c),g=a(6),m=n(g),h=a(7),p=n(h);a(186);var y=a(0),v=n(y);a(557);var x=a(187),b=n(x),N=a(184),I=a(487),w=r(I),_=a(183),T=r(_),S=function(e){function t(e){(0,s.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.state={tag:0,emptyText:"",inputValue:"",chargeValue:0,presentValue:0,focus:!1,organId:0,organName:"",presentList:[],rowList:[],openId:""},a}return(0,p.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(e){document.title="充值";var t=b.default.parse(this.props.location.search),a=t.organId?t.organId:0,r=t.organName?t.organName:"",n=t.openId?t.openId:"";this.state.organId=a,this.state.organName=r,this.state.openId=n,this.loadData()}},{key:"switchTag",value:function(e){var t=e.currentTarget.getAttribute("data-tag");this.switchTagAction(t)}},{key:"switchTagAction",value:function(e){var t=this.state.presentList[e],a=t.chargeAmount,r=t.presentAmount;this.setState({tag:e,chargeValue:a,presentValue:r})}},{key:"loadData",value:function(){var e=this;w.queryChargePresentList({organId:this.state.organId},{success:function(t){var a=t.data;if(a.length>0){for(var r=new Array,n=0;n<a.length;n++){var l=a[n];l.tag=n,l.chargeAmount=l.chargeAmount.toFixed(0),l.presentAmount=l.presentAmount.toFixed(0);var o=Math.floor(n/3),u=null;r.length<=o?(u=new Array,r.push(u)):u=r[o],u.push(l)}e.setState({presentList:t.data,rowList:r}),e.switchTagAction(0)}else e.setState({presentList:[],rowList:[],emptyText:"门店暂未开通充值业务"})},error:function(e){o.default.fail(e)}})}},{key:"charge",value:function(){o.default.loading("加载中...",30);var e={chargeAmount:this.state.chargeValue,organId:this.state.organId,openId:this.state.openId};w.charge(e,{success:function(e){o.default.hide();var t=e.data.tn,a=T.payUrl()+"?type=recharge&timestamp="+t.timeStamp+"&nonceStr="+t.nonceStr+"&prepay_id="+t.packageStr.substring(t.packageStr.indexOf("=")+1)+"&signType="+t.signType+"&paySign="+t.paySign+"&appId="+t.wxAppId,r=window.location.origin+"/xcx/#/mywallet";window.localStorage.setItem("wx_pay_callback_url",r),window.location.replace(a)},error:function(e){o.default.fail(e)}})}},{key:"render",value:function(){var e=this;return v.default.createElement("div",{className:"page"},v.default.createElement(N.Panel,null,v.default.createElement(N.Cell,{style:{fontSize:"16px"}},v.default.createElement(N.CellBody,null,"门店名称"),v.default.createElement(N.CellFooter,null,this.state.organName))),v.default.createElement(N.Panel,{style:{paddingBottom:"12px"}},0==this.state.rowList.length?v.default.createElement("div",{className:"charge_empty_text"},this.state.emptyText):v.default.createElement("div",null,this.state.rowList.map(function(t,a){return v.default.createElement(N.Flex,{key:a},t.map(function(t,a){return v.default.createElement(N.FlexItem,{key:a,"data-tag":t.tag,className:e.state.tag==t.tag?"charge_item selected":"charge_item",onClick:e.switchTag.bind(e)},t.presentAmount>0?v.default.createElement("div",null,v.default.createElement("div",{className:"charge_item_value"},t.chargeAmount,"元"),v.default.createElement("div",{className:"charge_item_present"},"赠送",t.presentAmount,"元")):v.default.createElement("div",{className:"charge_item_value",style:{marginTop:"20px"}},t.chargeAmount,"元"))}))}))),v.default.createElement("div",{className:"charge_tips"},"温馨提示: 您的充值金额只能用于当前网吧消费，赠送金额不能用于购买商品!"),v.default.createElement("div",{className:"charge_footer"},v.default.createElement(N.Flex,null,v.default.createElement(N.FlexItem,{style:{textAlign:"center"}},v.default.createElement("div",{className:"charge_text"},"金额: ",this.state.chargeValue>0?this.state.chargeValue:"--"," 元"),v.default.createElement("div",{className:"charge_present_text"},"(赠送 ",this.state.presentValue>0?this.state.presentValue:"--"," 元)")),v.default.createElement(N.FlexItem,{className:0==this.state.chargeValue?"charge_button disable":"charge_button",onClick:this.charge.bind(this)},"充值"))))}}]),t}(v.default.Component);t.default=S,e.exports=t.default},487:function(e,t,a){"use strict";function r(e,t){var a=e.type,r={type:a};return(0,N.default)("xcx/queryAppAdList.do",{method:"GET",body:r},t)}function n(e,t){var a=e.pageNum,r=e.name,n=e.latitude,l=e.longitude,o=e.serviceCode,u=e.orderBy,d={pageNum:a,latitude:n,longitude:l,orderBy:0};return r&&r.length>0&&(d.name=r),o&&o.length>0&&(d.serviceCode=o),u&&(d.orderBy=u),(0,N.default)("xcx/queryNearbyNetbar.do",{method:"POST",body:d},t)}function l(e,t){var a=e.organId,r=e.latitude,n=e.longitude,l={latitude:r,longitude:n};return a>0&&(l.organId=a),(0,N.default)("xcx/netbarDetail.do",{method:"POST",body:l},t)}function o(e,t){var a=e.organId,r=e.pageNum,n={organId:a,pageNum:r};return(0,N.default)("xcx/queryNetbarReviewList.do",{method:"POST",body:n},t)}function u(e,t){var a=e.organId,r={organId:a,type:0};return(0,N.default)("xcx/followNetbar.do",{method:"POST",body:r},t)}function d(e,t){var a=e.organId,r={organId:a,type:1};return(0,N.default)("xcx/followNetbar.do",{method:"POST",body:r},t)}function i(e,t){var a=e;return(0,N.default)("xcx/saveNetbarReview.do",{method:"POST",body:a},t)}function s(e,t){var a=e.organId,r={organId:a};return(0,N.default)("xcx/queryChargePresentList.do",{method:"GET",body:r},t)}function c(e,t){var a=e;return(0,N.default)("xcx/userSelfRechange.do",{method:"POST",body:a},t)}function f(e,t){var a=e.serviceCode,r=e.pageNum,n=e.latitude,l=e.longitude,o={serviceCode:a,pageNum:r,latitude:n,longitude:l};return(0,N.default)("xcx/queryFollowNetbarList.do",{method:"POST",body:o},t)}function g(e){var t={};return(0,N.default)("xcx/myCenter.do",{method:"POST",body:t},e)}function m(e,t){var a=e;return(0,N.default)("xcx/queryMyWallet.do",{method:"GET",body:a},t)}function h(e,t){var a=e.walletId,r=e.pageNum,n={walletId:a,pageNum:r};return(0,N.default)("xcx/queryMyWalletLog.do",{method:"POST",body:n},t)}function p(e,t){var a=e.pageNum,r={pageNum:a};return(0,N.default)("xcx/queryMyGoodsBill.do",{method:"POST",body:r},t)}function y(e,t){var a=e.nickName,r={nickName:a};return(0,N.default)("xcx/editUserInfo.do",{method:"POST",body:r},t)}function v(e,t){var a=e.saleBillId,r={saleBillId:a};return(0,N.default)("xcx/queryGoodsBillDetail.do",{method:"GET",body:r},t)}function x(e,t){var a=e.fileBase64,r=e.objectType,n={fileBase64:a,objectType:r};return(0,N.default)("xcx/uploadImage.do",{method:"POST",body:n},t)}Object.defineProperty(t,"__esModule",{value:!0}),t.loadAd=r,t.queryNearbyNetbar=n,t.queryNetbarDetail=l,t.queryNetbarReviewList=o,t.followNetbar=u,t.unfollowNetbar=d,t.addReview=i,t.queryChargePresentList=s,t.charge=c,t.queryFollowNetbarList=f,t.queryMyInfo=g,t.queryMyWallet=m,t.queryWalletLog=h,t.queryMyOrderList=p,t.editUserInfo=y,t.queryGoodsBillDetail=v,t.uploadImage=x;var b=a(188),N=function(e){return e&&e.__esModule?e:{default:e}}(b)},557:function(e,t){}});